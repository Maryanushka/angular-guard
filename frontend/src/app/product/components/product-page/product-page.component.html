<app-navigation></app-navigation>

@if (error$ | async) {
	<p class="error-message text-center font-bold">
		{{ error$ | async }}
	</p>
}

<div class="container flex max-w-[100%]">
	<div class="w-4/12 md:w-2/12">
		<product-categories></product-categories>
	</div>
	<div class="products-column flex flex-col mt-16 w-8/12 md:w-10/12">
		@if ($loading() && $products().length === 0) {
			<div class="products-column__loading" aria-live="polite" aria-busy="true">
				<p-progressSpinner aria-hidden="true"></p-progressSpinner>
				<span class="visually-hidden">Loading products</span>
			</div>
		}
		@if ($products().length === 0 && !$loading()) {
			<p class="text-center font-bold">No products found</p>
		}
		@if ($products().length > 0) {
			<div class="flex flex-wrap justify-start gap-2">
				@for (item of $products(); track item._slug) {
					<app-product class="flex w-60 m-2" [product]="item"></app-product>
				}
			</div>
			<div class="load-more-sentinel" appObserveInView (inView)="loadMore()" aria-hidden="true"></div>
			@if ($products().length < $total()) {
				<div class="scroll-hint" aria-hidden="true">
					<span class="scroll-hint__arrow" aria-hidden="true"></span>
				</div>
			}
		}
		@if ($loading() && $products().length > 0) {
			<p class="loading-more text-center text-sm text-gray-500 py-4">
				Loading moreâ€¦
				<p-progressSpinner aria-hidden="true"></p-progressSpinner>
			</p>
		}
	</div>
</div>

<app-social-media class="flex fixed right-8 bottom-4"></app-social-media>

<p-toast />
