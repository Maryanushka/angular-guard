<div class="min-h-screen flex flex-col container">
	<app-navigation></app-navigation>

	<div class="flex-1 w-full">
		@if (error$ | async; as error) {
			<p class="error-message text-center font-bold py-8 text-red-600">
				{{ error }}
			</p>
		}

		<div class="container flex max-w-[100%] mx-auto px-4 md:px-0 flex-col md:flex-row md:pt-16">
			<aside class="w-full md:w-2/12 mb-6 md:mb-0">
				<product-categories></product-categories>
			</aside>
			<div class="products-column flex flex-col w-full md:w-10/12">
				@let products = $products();
				@let loading = $loading();
				
				@if (loading && products.length === 0) {
					<div class="products-column__loading flex justify-center py-20" aria-live="polite" aria-busy="true">
						<p-progressSpinner aria-hidden="true"></p-progressSpinner>
						<span class="visually-hidden">{{ 'PRODUCT.LOADING' | translate }}</span>
					</div>
				} @else if (products.length === 0) {
					<div class="flex flex-col items-center justify-center py-20 text-center">
						<p class="font-bold text-gray-600 text-lg">{{ 'PRODUCT.NO_PRODUCTS_FOUND' | translate }}</p>
					</div>
				} @else {
					<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 md:gap-6">
						@for (item of products; track item._slug) {
							<app-product class="w-full" [product]="item"></app-product>
						}
					</div>
					<div class="load-more-sentinel h-4" appObserveInView (inView)="loadMore()" aria-hidden="true"></div>
					
					@if (products.length < $total()) {
						<div class="scroll-hint flex justify-center py-4" aria-hidden="true">
							<span class="scroll-hint__arrow animate-bounce text-gray-400"><i class="pi pi-arrow-down"></i></span>
						</div>
					}
				}

				@if (loading && products.length > 0) {
					<p class="loading-more text-center text-sm text-gray-500 py-4 flex items-center justify-center gap-2">
						{{ 'PRODUCT.LOADING_MORE' | translate }}
						<i class="pi pi-spin pi-spinner"></i>
					</p>
				}
			</div>
		</div>
	</div>

	<app-footer></app-footer>
</div>

<app-social-media class="fixed right-[0.5rem] md:right-6 bottom-6 z-50"></app-social-media>
